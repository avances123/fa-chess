    def init_menu(self):
        menubar = self.menuBar()
        
        # --- MENÚ ARCHIVO ---
        file_menu = menubar.addMenu("&Archivo")
        
        # Submenú Importar
        import_menu = file_menu.addMenu(qta.icon('fa5s.file-import'), "&Importar")
        import_parquet = QAction(qta.icon('fa5s.file-archive', color='#1976d2'), "Base &Parquet...", self)
        import_parquet.triggered.connect(self.open_parquet_file)
        import_menu.addAction(import_parquet)
        
        import_pgn = QAction(qta.icon('fa5s.file-code', color='#2e7d32'), "Archivo &PGN...", self)
        import_pgn.triggered.connect(self.import_pgn)
        import_menu.addAction(import_pgn)
        
        # Submenú Exportar
        export_menu = file_menu.addMenu(qta.icon('fa5s.file-export'), "&Exportar")
        export_full_pgn = QAction(qta.icon('fa5s.file-export'), "Base Activa a &PGN...", self)
        export_full_pgn.triggered.connect(self.export_full_db_to_pgn)
        export_menu.addAction(export_full_pgn)
        
        export_filtered_pgn = QAction(qta.icon('fa5s.filter'), "Filtro a P&GN...", self)
        export_filtered_pgn.setShortcut("Ctrl+E")
        export_filtered_pgn.triggered.connect(self.export_filter_to_pgn)
        export_menu.addAction(export_filtered_pgn)
        
        export_filtered_parquet = QAction(qta.icon('fa5s.file-archive', color='#1976d2'), "Filtro a Par&quet...", self)
        export_filtered_parquet.triggered.connect(self.export_filter_to_parquet)
        export_menu.addAction(export_filtered_parquet)
        
        file_menu.addSeparator()
        settings_action = QAction(qta.icon('fa5s.cog'), "&Configuración...", self)
        settings_action.triggered.connect(self.open_settings)
        file_menu.addAction(settings_action)
        
        file_menu.addSeparator()
        exit_action = QAction(qta.icon('fa5s.power-off'), "&Salir", self)
        exit_action.setShortcut("Ctrl+Q")
        exit_action.triggered.connect(self.close)
        file_menu.addAction(exit_action)

        # --- MENÚ JUGADOR ---
        player_menu = menubar.addMenu("&Jugador")
        report_action = QAction(qta.icon('fa5s.chart-bar', color='#673ab7'), "Dossier de &Inteligencia...", self)
        report_action.setShortcut("Ctrl+D")
        report_action.triggered.connect(self.prompt_player_report)
        player_menu.addAction(report_action)

        # --- MENÚ EDITAR ---
        edit_menu = menubar.addMenu("&Editar")
        invert_action = QAction(qta.icon('fa5s.exchange-alt'), "&Invertir Filtro", self)
        invert_action.triggered.connect(self.trigger_invert_filter)
        edit_menu.addAction(invert_action)
        
        clear_action = QAction(qta.icon('fa5s.eraser', color='#c62828'), "&Quitar Filtros", self)
        clear_action.setShortcut("Ctrl+L")
        clear_action.triggered.connect(self.reset_filters)
        edit_menu.addAction(clear_action)
        
        edit_menu.addSeparator()
        delete_filtered_action = QAction(qta.icon('fa5s.trash-alt', color='#c62828'), "&Borrar Partidas Filtradas", self)
        delete_filtered_action.triggered.connect(self.delete_filtered_games_ui)
        edit_menu.addAction(delete_filtered_action)

        # --- MENÚ BASES DE DATOS ---
        db_menu = menubar.addMenu("&Bases de Datos")
        new_db_action = QAction(qta.icon('fa5s.plus-circle', color='#2e7d32'), "Nueva Base &Vacía...", self)
        new_db_action.setShortcut("Ctrl+N")
        new_db_action.triggered.connect(self.create_new_db)
        db_menu.addAction(new_db_action)
        
        append_pgn_action = QAction(qta.icon('fa5s.file-medical', color='#2e7d32'), "Añadir PGN a la base &activa...", self)
        append_pgn_action.triggered.connect(self.append_pgn_to_current_db)
        db_menu.addAction(append_pgn_action)
        
        db_menu.addSeparator()
        filter_action = QAction(qta.icon('fa5s.search'), "&Filtrar Partidas...", self)
        filter_action.setShortcut("Ctrl+F")
        filter_action.triggered.connect(self.open_search)
        db_menu.addAction(filter_action)
        
        db_menu.addSeparator()
        delete_db_action = QAction(qta.icon('fa5s.trash-alt'), "&Eliminar Archivo de Base...", self)
        delete_db_action.triggered.connect(self.delete_current_db_file)
        db_menu.addAction(delete_db_action)

        # --- MENÚ TABLERO ---
        board_menu = menubar.addMenu("&Tablero")
        flip_action = QAction(qta.icon('fa5s.retweet'), "&Girar Tablero", self); flip_action.setShortcut("F"); flip_action.triggered.connect(self.flip_boards); board_menu.addAction(flip_action)
        engine_action = QAction(qta.icon('fa5s.microchip'), "&Activar Motor", self); engine_action.setShortcut("E"); engine_action.setCheckable(True); engine_action.triggered.connect(self.toggle_engine_shortcut); board_menu.addAction(engine_action)
        
        # --- MENÚ AYUDA ---
        help_menu = menubar.addMenu("&Ayuda")
        about_action = QAction(qta.icon('fa5s.info-circle'), "&Acerca de...", self); about_action.triggered.connect(self.show_about_dialog); help_menu.addAction(about_action)
